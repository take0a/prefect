---
title: シェルコマンドをフローとして実行する
description: Prefect CLI を使用してシェル コマンドをフローとして実行する方法を学びます。
---

このページでは、Prefect CLI コマンドの「watch」と「serve」を使用して、シェルコマンドを Prefect フローとして実行およびスケジュールする方法について説明します。具体的には以下の操作を行います。

- 「watch」を使用して、シェルコマンドを Prefect フローとしてオンデマンドで実行する
- 「serve」を使用して、シェルコマンドを繰り返し実行する Prefect フローとしてスケジュールする

## 前提条件
始める前に、以下の条件を満たしていることを確認してください。

- Prefect フローの基本的な理解。
必要に応じて、[はじめに](/v3/get-started/quickstart/)ガイドを参照してください。
- コマンドライン環境に最新バージョンの Prefect がインストールされている。
問題が発生した場合は、こちらの[手順](/v3/get-started/install/)に従ってください。

## `watch` コマンド
`watch` コマンドは、任意のシェルコマンドを Prefect フローにラップして、即座に実行できるようにします。
これは、簡単なタスクやシェルスクリプトをワークフローに統合するのに最適です。

### 使用例
`curl` コマンドを使用してシカゴの現在の天気を取得するには、次の Prefect CLI コマンドを使用します。

```bash
prefect shell watch "curl http://wttr.in/Chicago?format=3"
```

このコマンドは、コンソール向けの天気予報サービスである `wttr.in` にリクエストを送信し、シカゴの天気状況を出力します。

### `watch` のメリット
- **即時フィードバック:** Prefect フレームワーク内でシェルコマンドを実行し、すぐに結果を得ることができます。
- **容易な統合:** 外部スクリプトやデータ取得をデータワークフローに組み込むことができます。
- **可視性とログ記録:** Prefect のログ記録を使用して、シェルタスクの実行と出力を追跡できます。

## `serve` を使ったデプロイ
シェルコマンドをスケジュールに従って実行するために、`serve` コマンドは定期的に実行される Prefect [デプロイメント](/v3/deploy/infrastructure-examples/docker/) を作成します。
これは、Prefect によって提供されるデプロイメントを素早く作成する方法です。

### 使用例
シカゴの午前9時の毎日の天気予報を設定するには、次のように「serve」コマンドを使用します。

```bash
prefect shell serve "curl http://wttr.in/Chicago?format=3" --flow-name "Daily Chicago Weather Report" --cron-schedule "0 9 * * *" --deployment-name "Chicago Weather"
```

このコマンドは、Prefect フローをスケジュールしてシカゴの天気情報を毎日取得し、手動操作なしで一貫した更新情報を提供します。
シカゴの天気情報を手動で取得するには、UI または CLI から新しいデプロイメントの実行を作成します。

サーバーをシャットダウンしてスケジュールされた実行を一時停止するには、CLI で `ctrl` + `c` を押します。

### `serve` のメリット
- **自動スケジューリング:** シェルコマンドの自動実行をスケジュール設定することで、重要な更新が時間どおりに生成され、利用可能になります。
- **一元化されたワークフロー管理:** スケジュールされたシェルコマンドを Prefect 内で管理・監視し、ワークフローの概要を一元的に把握できます。
- **設定可能な実行:** 実行頻度、[同時実行制限](/v3/develop/global-concurrency-limits/)、その他のパラメータを、プロジェクトのニーズやリソースに合わせてカスタマイズできます。
